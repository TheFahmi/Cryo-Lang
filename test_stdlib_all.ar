import "stdlib/math.ar";
import "stdlib/string.ar";
import "stdlib/array.ar";
import "stdlib/random.ar";
import "stdlib/result.ar";
import "stdlib/map.ar";
import "stdlib/set.ar";
import "stdlib/testing.ar";

fn main() {
    test_suite("Argon Standard Library v2.7.1");
    
    // Math tests
    test("abs");
    assert_eq(abs(0 - 10), 10, "abs(-10) = 10");
    
    test("max");
    assert_eq(max(5, 15), 15, "max(5, 15) = 15");
    
    test("pow");
    assert_eq(pow(2, 3), 8, "2^3 = 8");
    
    test("gcd");
    assert_eq(gcd(12, 8), 4, "gcd(12,8) = 4");
    
    // String tests
    test("str_len");
    assert_eq(str_len("Hello"), 5, "len('Hello') = 5");
    
    test("contains");
    assert_true(contains("Hello World", "World"), "contains works");
    
    test("substring");
    assert_eq(substring("Hello", 0, 3), "Hel", "substring works");
    
    // Array tests
    test("array_len");
    let arr = [1, 2, 3, 4, 5];
    assert_eq(array_len(arr), 5, "len([1,2,3,4,5]) = 5");
    
    test("array_contains");
    assert_true(array_contains(arr, 3), "array_contains works");
    
    // Random tests
    test("random_int");
    random_seed(42);
    let r = random_int(1, 100);
    assert_gte(r, 1, "random >= 1");
    assert_lte(r, 100, "random <= 100");
    
    // Result tests
    test("Result_Ok");
    let ok_result = Ok(42);
    assert_true(is_ok(ok_result), "is_ok returns true");
    assert_eq(unwrap(ok_result), 42, "unwrap returns value");
    
    // Map tests
    test("map_operations");
    let m = map_new();
    m = map_set(m, "name", "Argon");
    m = map_set(m, "version", "2.7.1");
    assert_eq(map_size(m), 2, "map has 2 entries");
    assert_eq(map_get(m, "name"), "Argon", "map_get works");
    
    // Set tests
    test("set_operations");
    let s1 = set_from([1, 2, 3, 2, 1]);
    assert_eq(set_size(s1), 3, "set removes duplicates");
    
    let s2 = set_from([2, 3, 4]);
    let u = set_union(s1, s2);
    assert_eq(set_size(u), 4, "union has 4 elements");
    
    test_summary();
    
    return 0;
}
