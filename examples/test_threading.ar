// Test Multi-threading in Argon
// Tests: thread_spawn, thread_join, atomic operations

fn worker() {
    print("Worker thread started");
    argon_sleep(100);
    print("Worker thread done");
    return 42;
}

fn main() {
    print("=== Multi-threading Test ===");
    
    // Test 1: Atomic counter
    print("Test 1: Atomic operations");
    let counter = argon_atomic_new(0);
    argon_atomic_add(counter, 5);
    argon_atomic_add(counter, 3);
    let val = argon_atomic_load(counter);
    print("Atomic counter value (should be 8):");
    print(val);
    
    // Test 2: Atomic CAS
    print("Test 2: Compare-and-swap");
    let success = argon_atomic_cas(counter, 8, 100);
    print("CAS success (should be 1):");
    print(success);
    let new_val = argon_atomic_load(counter);
    print("New value (should be 100):");
    print(new_val);
    
    // Test 3: Sleep
    print("Test 3: Sleep");
    print("Sleeping 200ms...");
    argon_sleep(200);
    print("Woke up!");
    
    print("=== All tests passed ===");
}
